<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Raspberry Pi Pico</title>
    <link rel="icon" type="image/png" href="https://www.raspberrypi.com/app/themes/mind-control/images/favicon.png" />

    <!-- Bootstrap v5.2.3 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
  </head>
  <body>
    <label class="form-check-label" for="LedSwitch">LED state is <b id="led_state">{rpi_led}</b></label>
    <div class="form-check form-switch">
      <input class="form-check-input" type="checkbox" role="switch" onclick="toggleLED()" id="LedSwitch">
    </div>
    <p>Temperature is {rpi_temp}</p>

    <script>
      let state = "{rpi_led}";
      let endpoint = "/led/".concat(state === "ON" ? "off" : "on");

      function toggleLED() {
        let xhttp = new XMLHttpRequest();
        xhttp.onreadystatechange = function() {
          if (this.readyState == 4 && (this.status == 200 || this.status == 0)) {
            endpoint = "/led/" + state.toLowerCase();
            state = state === "ON" ? "OFF" : "ON";
            document.getElementById("led_state").innerHTML = state;
          }
        };
        xhttp.open("POST", endpoint);
        xhttp.send();
      }
    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.min.js" integrity="sha384-cuYeSxntonz0PPNlHhBs68uyIAVpIIOZZ5JqeqvYYIcEL727kskC66kF92t6Xl2V" crossorigin="anonymous"></script>
  </body>
</html>
